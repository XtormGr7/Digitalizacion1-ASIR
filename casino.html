<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>Trabajo digitalizacion</title>
    <meta name="digitalizacion" content="Estructura de 3 habitaciones">
    
    <!-- A-Frame Core -->
    <script src="https://aframe.io/releases/1.4.2/aframe.min.js"></script>
    <!-- Physics System -->
    <script src="https://cdn.jsdelivr.net/gh/n5ro/aframe-physics-system@v4.0.1/dist/aframe-physics-system.min.js"></script>
    <!-- A-Frame Extras (Controls, etc.) -->
    <script src="https://cdn.jsdelivr.net/gh/c-frame/aframe-extras@7.0.0/dist/aframe-extras.min.js"></script>

    <script>
        // componentes para la interaccion de las puertas
        AFRAME.registerComponent('interactive-door', {
            schema: {
                isOpen: {type: 'boolean', default: false},
                axis: {type: 'string', default: 'y'}, // Axis de rotacion
                direction: {type: 'number', default: 90} // grados de rotacion
            },
            init: function () {
                var el = this.el;
                var data = this.data;
                
                // Guardar rotación inicial
                this.initialRotation = el.getAttribute('rotation').y;
                
                // añadir sonido al hacer click
                el.addEventListener('click', (evt) => {
                    // Abrir y cerrar dependiendo de su estado
                    let targetRotation = data.isOpen ? this.initialRotation : (this.initialRotation + data.direction);
                    
                    el.setAttribute('animation', {
                        property: 'rotation.y',
                        to: targetRotation,
                        dur: 1000,
                        easing: 'easeInOutQuad'
                    });
                    
                    // reproducir un sonido
                    data.isOpen = !data.isOpen;
                });

                // Cambiar el cursor al pasar el ratón por encima para indicar interactividad.
                el.addEventListener('mouseenter', () => {
                    el.setAttribute('material', 'color', '#FFD700'); // Brillo dorado
                });
                el.addEventListener('mouseleave', () => {
                    el.setAttribute('material', 'color', '#8B4513'); // Volver a la madera
                });
            }
        });
    </script>
</head>
<body>
    <a-scene physics="debug: false; gravity: -9.8">
        
        <!-- ASSETS -->
        <a-assets>
            <img id="grass" src="https://cdn.aframe.io/360-image-gallery-boilerplate/img/city.jpg"> <!-- Placeholder texture if needed, utilizing color mostly -->
        </a-assets>

        <!-- Fisica del jugador -->
        <!-- Un cuerpo cinemático permite al jugador colisionar con paredes estáticas. -->
        <a-entity id="rig" movement-controls="speed: 0.2" kinematic-body position="0 0 15">
            <a-entity camera position="0 1.6 0" look-controls="pointerLockEnabled: true">
                <a-cursor color="white" fuse="false" raycaster="objects: .clickable"></a-cursor>
            </a-entity>
        </a-entity>

        <!-- Iluminación -->
        <a-entity light="type: ambient; color: #BBB; intensity: 0.5"></a-entity>
        <a-entity light="type: directional; color: #FFF; intensity: 0.8; castShadow: true" position="-1 2 1"></a-entity>

        <!-- Entorno exterior -->
        <!-- Suelo -->
        <a-plane static-body rotation="-90 0 0" width="100" height="100" color="#4CAF50"></a-plane>
        
        <!-- Arboles (Procedural) -->
        <!-- Arbol 1 -->
        <a-entity position="-10 0 10">
            <a-cylinder position="0 0.75 0" radius="0.5" height="1.5" color="#5D4037" static-body></a-cylinder>
            <a-cone position="0 2.5 0" radius-bottom="2" radius-top="0" height="3" color="#2E7D32"></a-cone>
        </a-entity>
        <!-- Arbol 2 -->
        <a-entity position="12 0 8">
            <a-cylinder position="0 0.75 0" radius="0.5" height="1.5" color="#5D4037" static-body></a-cylinder>
            <a-cone position="0 2.5 0" radius-bottom="2" radius-top="0" height="3" color="#2E7D32"></a-cone>
        </a-entity>
        <!-- Arbol 3 -->
        <a-entity position="-15 0 -5">
            <a-cylinder position="0 0.75 0" radius="0.5" height="1.5" color="#5D4037" static-body></a-cylinder>
            <a-cone position="0 2.5 0" radius-bottom="2" radius-top="0" height="3" color="#2E7D32"></a-cone>
        </a-entity>
        <!-- Arbol 4 -->
        <a-entity position="15 0 -10">
            <a-cylinder position="0 0.75 0" radius="0.5" height="1.5" color="#5D4037" static-body></a-cylinder>
            <a-cone position="0 2.5 0" radius-bottom="2" radius-top="0" height="3" color="#2E7D32"></a-cone>
        </a-entity>


        <!-- Estructura del edificio -->
        <a-entity position="0 0 0">
            
            <!-- Suelo (Interior) -->
            <a-box static-body position="0 0.1 0" width="10" height="0.2" depth="10" color="#795548"></a-box>
            
            <!-- Techo -->
            <a-box static-body position="0 3.1 0" width="10" height="0.2" depth="10" color="#CCCCCC"></a-box>

            <!-- Paredes exteriores -->
            <!-- Pared trasera -->
            <a-box static-body position="0 1.5 -5" width="10" height="3" depth="0.2" color="#607D8B"></a-box>
            <!-- Pared izquierda -->
            <a-box static-body position="-5 1.5 0" width="0.2" height="3" depth="10" color="#607D8B"></a-box>
            <!-- Pared derecha -->
            <a-box static-body position="5 1.5 0" width="0.2" height="3" depth="10" color="#607D8B"></a-box>
            
            <!--Pared frontal(divide las puertas interiores) -->
            <!-- Parte izquierda -->
            <a-box static-body position="-3.5 1.5 5" width="3" height="3" depth="0.2" color="#607D8B"></a-box>
            <!-- Parte derecha -->
            <a-box static-body position="3.5 1.5 5" width="3" height="3" depth="0.2" color="#607D8B"></a-box>
            <!-- Dintel -->
            <a-box static-body position="0 2.75 5" width="4" height="0.5" depth="0.2" color="#607D8B"></a-box>

            <!-- Puertas principales(con pomo) -->
            <!-- Contenedor de pivote para rotar desde la bisagra -->
           <a-entity position="-2 0 5" interactive-door="direction: -90">
    <a-box class="clickable" 
           position="1 1 0" width="2" height="3" depth="0.1" color="#8B4513" static-body>
           <a-sphere position="0.8 0 0.1" radius="0.1" color="gold"></a-sphere>
    </a-box>
</a-entity>

<a-entity position="2 0 5" interactive-door="direction: 90">
    <a-box class="clickable"
           position="-1 1 0" width="2" height="3" depth="0.1" color="#8B4513" static-body>
           <a-sphere position="-0.8 0 0.1" radius="0.1" color="gold"></a-sphere>
    </a-box>
</a-entity>
    </a-box>
</a-entity>

            <!-- Pieza de pared 1 (Izquierda) -->
            <a-box static-body position="-3.5 1.5 0" width="3" height="3" depth="0.2" color="#CFD8DC"></a-box>
            <!-- Pieza de pared 2 (Derecha)) -->
            <a-box static-body position="3.5 1.5 0" width="3" height="3" depth="0.2" color="#CFD8DC"></a-box>
            <!-- Dindel interior -->
            <a-box static-body position="0 3 0" width="4" height="1" depth="0.2" color="#CFD8DC"></a-box>

            <!-- Pared que separa las Habitaciones Traseras (Habitación 2 y Habitación 3) -->
            <!-- Recorriendo el eje Z desde Z=0 hasta Z=-5 en X=0 -->
            <a-box static-body position="0 1.5 -2.5" width="0.2" height="3" depth="5" color="#CFD8DC"></a-box>

            <!-- Puertas internas (izquierda y derecha) -->
            <a-entity position="-2.1 0 0" interactive-door="direction: -90">
    <a-box class="clickable"
           position="1 1 0" width="2" height="3" depth="0.05" color="#8B4513" static-body>
    </a-box>
</a-entity>

<a-entity position="2.1 0 0" interactive-door="direction: 90">
    <a-box class="clickable"
           position="-1 1 0" width="2" height="3" depth="0.05" color="#8B4513" static-body>
    </a-box>
</a-entity>


            <!-- Luces de la habitación (Luces puntuales) -->
            <!-- Entrada -->
            <a-entity light="type: point; intensity: 0.6; distance: 10; color: #FFD700" position="0 2.5 2.5"></a-entity>
            <!-- Habitacion izquierda -->
            <a-entity light="type: point; intensity: 0.5; distance: 8; color: #00FFFF" position="-2.5 2.5 -2.5"></a-entity>
            <!-- Habitacion derecha -->
            <a-entity light="type: point; intensity: 0.5; distance: 8; color: #FF00FF" position="2.5 2.5 -2.5"></a-entity>

        </a-entity>

    </a-scene>
</body>
</html>